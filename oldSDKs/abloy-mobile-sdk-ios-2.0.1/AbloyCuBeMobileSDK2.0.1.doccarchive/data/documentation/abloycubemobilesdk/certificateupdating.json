{"metadata":{"title":"Certificate Updating","modules":[{"name":"AbloyCuBeMobileSDK"}],"roleHeading":"Article","role":"article"},"seeAlsoSections":[{"title":"Locking Device Certificate Updates","identifiers":["doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming\/getLockCertificateEvents()","doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateEvent"],"anchor":"Locking-Device-Certificate-Updates","generated":true}],"variants":[{"paths":["\/documentation\/abloycubemobilesdk\/certificateupdating"],"traits":[{"interfaceLanguage":"swift"}]}],"primaryContentSections":[{"kind":"content","content":[{"type":"heading","text":"Overview","anchor":"Overview","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"The Abloy Keyless solution uses asymmetric cryptography to secure the communication between locking devices and mobile"},{"type":"text","text":" "},{"type":"text","text":"devices. Each locking device has its of own certificate for establishing this secure communication. The certificates"},{"type":"text","text":" "},{"type":"text","text":"also have an expiration date. Locking devices with expired certificates are inoperable and are considered untrustworthy"},{"type":"text","text":" "},{"type":"text","text":"for the rest of the Keyless system."}]},{"type":"paragraph","inlineContent":[{"text":"In order to keep locking devices operational and trustworthy, their certificates need to be updated.","type":"text"},{"text":" ","type":"text"},{"text":"Update is performed automatically in the background by the Abloy Keyless Mobile SDK. It is worth to note that","type":"text"},{"text":" ","type":"text"},{"text":"any mobile device user connecting to a lock may start the update process at any given time.","type":"text"}]},{"name":"Important","type":"aside","content":[{"inlineContent":[{"type":"text","text":""},{"type":"text","text":" "},{"type":"text","text":"This process happens very rarely, approximately once a year. No action from the mobile app using the SDK is required."}],"type":"paragraph"}],"style":"important"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Current status of the locking device certificate is checked when performing lock connection."},{"type":"text","text":" "},{"type":"text","text":"If the certificate needs to be updated, new certificate will be fetched and installed to the"},{"type":"text","text":" "},{"type":"text","text":"locking device. During the update process, the locking device will reboot and reconnect after the new"},{"type":"text","text":" "},{"type":"text","text":"certificate is installed to the locking device."}]},{"type":"heading","text":"Discovered lock and certificate state","anchor":"Discovered-lock-and-certificate-state","level":2},{"type":"paragraph","inlineContent":[{"text":"SDK integrators can determine whether update process will happen on next locking device connection from the","type":"text"},{"text":" ","type":"text"},{"text":"DiscoveredLockâ€™s ","type":"text"},{"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock\/certificateState","type":"reference","isActive":true},{"text":". If the state is either ","type":"text"},{"overridingTitle":"pending","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/pending","type":"reference","isActive":true,"overridingTitleInlineContent":[{"type":"codeVoice","code":"pending"}]},{"text":",","type":"text"},{"text":" ","type":"text"},{"overridingTitle":"issuing","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/issuing","type":"reference","isActive":true,"overridingTitleInlineContent":[{"code":"issuing","type":"codeVoice"}]},{"text":" or ","type":"text"},{"overridingTitle":"readyForInstall","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/readyForInstall","type":"reference","isActive":true,"overridingTitleInlineContent":[{"type":"codeVoice","code":"readyForInstall"}]},{"text":", the next","type":"text"},{"text":" ","type":"text"},{"text":"connection will start the certificate updating process.","type":"text"}]},{"type":"heading","text":"How to listen for certificate update events","anchor":"How-to-listen-for-certificate-update-events","level":2},{"type":"paragraph","inlineContent":[{"text":"Certificate update events of the connected locking device can be listened by","type":"text"},{"text":" ","type":"text"},{"text":"calling ","type":"text"},{"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming\/getLockCertificateEvents()","type":"reference","isActive":true},{"text":" API. These update events can be used to convey","type":"text"},{"text":" ","type":"text"},{"text":"information to end users, for example update app UI based on events. When there is no ongoing update process,","type":"text"},{"text":" ","type":"text"},{"text":"events will not be emitted.","type":"text"}]},{"name":"Tip","type":"aside","content":[{"inlineContent":[{"type":"text","text":""},{"type":"text","text":" "},{"type":"text","text":"Sample code and additional documentation can be found "},{"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming\/getLockCertificateEvents()","type":"reference","isActive":true,"overridingTitle":"here","overridingTitleInlineContent":[{"type":"text","text":"here"}]}],"type":"paragraph"}],"style":"tip"},{"type":"heading","text":"Request queued state","anchor":"Request-queued-state","level":2},{"inlineContent":[{"text":"Certificate update process requires internet connection. If internet connection is not available or network","type":"text"},{"text":" ","type":"text"},{"text":"error occurs, certificate update will end up in ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateStateChange\/requestQueued"},{"text":" -state.","type":"text"},{"text":" ","type":"text"},{"text":"Certificate update will be tried again when connecting to the locking device next time.","type":"text"}],"type":"paragraph"},{"style":"important","name":"Important","content":[{"inlineContent":[{"type":"text","text":""},{"type":"text","text":" "},{"type":"text","text":"In case the locking device firmware version does not support update, the SDK will broadcast a"},{"type":"text","text":" "},{"type":"reference","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateStateChange\/certificateUpdateNotSupported","isActive":true},{"type":"text","text":" event. Certificate update process will not start"},{"type":"text","text":" "},{"type":"text","text":"if the firmware does not support it."}],"type":"paragraph"}],"type":"aside"},{"style":"note","name":"Note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":""},{"type":"text","text":" "},{"type":"text","text":"If internet connection is not available during the certificate update process, it is possible to"},{"type":"text","text":" "},{"type":"text","text":"try to request the certificate in background when app is not active and the mobile device"},{"type":"text","text":" "},{"type":"text","text":"is connected to the internet by "},{"overridingTitleInlineContent":[{"type":"text","text":"enabling background syncing"}],"type":"reference","isActive":true,"overridingTitle":"enabling background syncing","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/BackgroundSyncing"},{"type":"text","text":"."}]}],"type":"aside"},{"level":2,"anchor":"Further-Reading","text":"Further Reading","type":"heading"},{"style":"list","items":["doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/Connecting","doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock","doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/BackgroundSyncing"],"type":"links"}]}],"identifier":{"url":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateUpdating","interfaceLanguage":"swift"},"hierarchy":{"paths":[["doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK"]]},"kind":"article","sections":[],"abstract":[{"type":"text","text":"Update the certificate of the locking device."}],"schemaVersion":{"major":0,"minor":3,"patch":0},"references":{"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/CertificateState/readyForInstall":{"url":"\/documentation\/abloycubemobilesdk\/certificatestate\/readyforinstall","type":"topic","abstract":[{"type":"text","text":"Lock certificate is downloaded and will be installed next time the locking device is connected"}],"fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"text":"readyForInstall","kind":"identifier"}],"title":"CertificateState.readyForInstall","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/readyForInstall","role":"symbol","kind":"symbol"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockingDeviceCertificateStateChange/certificateUpdateNotSupported":{"role":"symbol","fragments":[{"kind":"keyword","text":"case"},{"kind":"text","text":" "},{"kind":"identifier","text":"certificateUpdateNotSupported"}],"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateStateChange\/certificateUpdateNotSupported","url":"\/documentation\/abloycubemobilesdk\/lockingdevicecertificatestatechange\/certificateupdatenotsupported","type":"topic","abstract":[{"type":"text","text":"Locking device model or locking device firmware version does not support certificate updating"}],"title":"LockingDeviceCertificateStateChange.certificateUpdateNotSupported","kind":"symbol"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockCertificateEventStreaming":{"role":"symbol","title":"LockCertificateEventStreaming","abstract":[{"text":"Get locking device certificate update events","type":"text"}],"url":"\/documentation\/abloycubemobilesdk\/lockcertificateeventstreaming","type":"topic","fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"LockCertificateEventStreaming","kind":"identifier"}],"navigatorTitle":[{"text":"LockCertificateEventStreaming","kind":"identifier"}],"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming","kind":"symbol"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/DiscoveredLock":{"type":"topic","abstract":[{"text":"Represents a locking device that is advertising and has been discovered by bluetooth scanning.","type":"text"}],"role":"symbol","navigatorTitle":[{"kind":"identifier","text":"DiscoveredLock"}],"kind":"symbol","url":"\/documentation\/abloycubemobilesdk\/discoveredlock","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock","title":"DiscoveredLock","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"DiscoveredLock"}]},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/Connecting":{"title":"Connecting to a Locking Device","abstract":[{"text":"Connect to and disconnect from a nearby locking device.","type":"text"}],"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/Connecting","type":"topic","role":"article","url":"\/documentation\/abloycubemobilesdk\/connecting","kind":"article"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockCertificateEventStreaming/getLockCertificateEvents()":{"fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"getLockCertificateEvents"},{"kind":"text","text":"() -> "},{"kind":"typeIdentifier","text":"AsyncStream","preciseIdentifier":"s:ScS"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"LockingDeviceCertificateEvent","preciseIdentifier":"s:18AbloyCuBeMobileSDK29LockingDeviceCertificateEventV"},{"kind":"text","text":">"}],"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming\/getLockCertificateEvents()","url":"\/documentation\/abloycubemobilesdk\/lockcertificateeventstreaming\/getlockcertificateevents()","type":"topic","abstract":[{"type":"text","text":"Stream of events when lock certificate update is ongoing"}],"role":"symbol","title":"getLockCertificateEvents()","kind":"symbol","required":true},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK":{"abstract":[{"type":"text","text":"Control Abloy locking devices from within your app."}],"title":"AbloyCuBeMobileSDK","kind":"symbol","type":"topic","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK","role":"collection","url":"\/documentation\/abloycubemobilesdk"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/CertificateState/pending":{"title":"CertificateState.pending","kind":"symbol","type":"topic","role":"symbol","url":"\/documentation\/abloycubemobilesdk\/certificatestate\/pending","abstract":[{"type":"text","text":"Lock certificate will expire soon and a new certificate will be requested next time the locking"},{"type":"text","text":" "},{"type":"text","text":"device is connected"}],"fragments":[{"kind":"keyword","text":"case"},{"kind":"text","text":" "},{"kind":"identifier","text":"pending"}],"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/pending"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/BackgroundSyncing":{"title":"Background Syncing","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/BackgroundSyncing","abstract":[{"text":"Synchronize and process SDK data in background when the application is not active","type":"text"}],"kind":"article","url":"\/documentation\/abloycubemobilesdk\/backgroundsyncing","type":"topic","role":"article"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/CertificateState/issuing":{"title":"CertificateState.issuing","abstract":[{"text":"Server is preparing lock certificate","type":"text"}],"url":"\/documentation\/abloycubemobilesdk\/certificatestate\/issuing","type":"topic","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/issuing","kind":"symbol","role":"symbol","fragments":[{"kind":"keyword","text":"case"},{"kind":"text","text":" "},{"kind":"identifier","text":"issuing"}]},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/DiscoveredLock/certificateState":{"abstract":[],"fragments":[{"text":"let","kind":"keyword"},{"text":" ","kind":"text"},{"text":"certificateState","kind":"identifier"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:18AbloyCuBeMobileSDK16CertificateStateO","text":"CertificateState","kind":"typeIdentifier"}],"title":"certificateState","url":"\/documentation\/abloycubemobilesdk\/discoveredlock\/certificatestate","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock\/certificateState","kind":"symbol","role":"symbol","type":"topic"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockingDeviceCertificateStateChange/requestQueued":{"kind":"symbol","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateStateChange\/requestQueued","title":"LockingDeviceCertificateStateChange.requestQueued","fragments":[{"kind":"keyword","text":"case"},{"kind":"text","text":" "},{"kind":"identifier","text":"requestQueued"}],"type":"topic","url":"\/documentation\/abloycubemobilesdk\/lockingdevicecertificatestatechange\/requestqueued","role":"symbol","abstract":[{"text":"Certificate requesting failed due to a network error and requesting is being queued","type":"text"}]},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockingDeviceCertificateEvent":{"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"LockingDeviceCertificateEvent","kind":"identifier"}],"role":"symbol","title":"LockingDeviceCertificateEvent","navigatorTitle":[{"text":"LockingDeviceCertificateEvent","kind":"identifier"}],"kind":"symbol","abstract":[{"text":"Locking device certificate update event received by subscribing to ","type":"text"},{"isActive":true,"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming","type":"reference"}],"url":"\/documentation\/abloycubemobilesdk\/lockingdevicecertificateevent","type":"topic","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateEvent"}}}