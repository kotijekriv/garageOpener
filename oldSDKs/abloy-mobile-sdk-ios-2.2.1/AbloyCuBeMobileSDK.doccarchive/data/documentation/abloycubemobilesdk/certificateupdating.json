{"metadata":{"modules":[{"name":"AbloyCuBeMobileSDK"}],"role":"article","title":"Certificate Updating","roleHeading":"Article"},"abstract":[{"type":"text","text":"Update the certificate of the locking device."}],"variants":[{"paths":["\/documentation\/abloycubemobilesdk\/certificateupdating"],"traits":[{"interfaceLanguage":"swift"}]}],"sections":[],"identifier":{"url":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateUpdating","interfaceLanguage":"swift"},"kind":"article","primaryContentSections":[{"content":[{"level":2,"text":"Overview","anchor":"Overview","type":"heading"},{"inlineContent":[{"type":"text","text":"The Abloy Keyless solution uses asymmetric cryptography to secure the communication between locking devices and mobile"},{"type":"text","text":" "},{"type":"text","text":"devices. Each locking device has its of own certificate for establishing this secure communication. The certificates"},{"type":"text","text":" "},{"type":"text","text":"also have an expiration date. Locking devices with expired certificates are inoperable and are considered untrustworthy"},{"type":"text","text":" "},{"type":"text","text":"for the rest of the Keyless system."}],"type":"paragraph"},{"inlineContent":[{"text":"In order to keep locking devices operational and trustworthy, their certificates need to be updated.","type":"text"},{"text":" ","type":"text"},{"text":"Update is performed automatically in the background by the Abloy Keyless Mobile SDK. It is worth to note that","type":"text"},{"text":" ","type":"text"},{"text":"any mobile device user connecting to a lock may start the update process at any given time.","type":"text"}],"type":"paragraph"},{"name":"Important","style":"important","content":[{"inlineContent":[{"type":"text","text":""},{"type":"text","text":" "},{"type":"text","text":"This process happens very rarely, approximately once a year. No action from the mobile app using the SDK is required."}],"type":"paragraph"}],"type":"aside"},{"inlineContent":[{"text":"Current status of the locking device certificate is checked when performing lock connection.","type":"text"},{"text":" ","type":"text"},{"text":"If the certificate needs to be updated, new certificate will be fetched and installed to the","type":"text"},{"text":" ","type":"text"},{"text":"locking device. During the update process, the locking device will reboot and reconnect after the new","type":"text"},{"text":" ","type":"text"},{"text":"certificate is installed to the locking device.","type":"text"}],"type":"paragraph"},{"level":2,"text":"Discovered lock and certificate state","anchor":"Discovered-lock-and-certificate-state","type":"heading"},{"inlineContent":[{"text":"SDK integrators can determine whether update process will happen on next locking device connection from the","type":"text"},{"text":" ","type":"text"},{"text":"DiscoveredLockâ€™s ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock\/certificateState"},{"text":". If the state is either ","type":"text"},{"isActive":true,"overridingTitle":"pending","overridingTitleInlineContent":[{"code":"pending","type":"codeVoice"}],"type":"reference","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/pending"},{"text":",","type":"text"},{"text":" ","type":"text"},{"isActive":true,"overridingTitle":"issuing","overridingTitleInlineContent":[{"code":"issuing","type":"codeVoice"}],"type":"reference","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/issuing"},{"text":" or ","type":"text"},{"isActive":true,"overridingTitle":"readyForInstall","overridingTitleInlineContent":[{"code":"readyForInstall","type":"codeVoice"}],"type":"reference","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/readyForInstall"},{"text":", the next","type":"text"},{"text":" ","type":"text"},{"text":"connection will start the certificate updating process.","type":"text"}],"type":"paragraph"},{"level":2,"text":"How to listen for certificate update events","anchor":"How-to-listen-for-certificate-update-events","type":"heading"},{"inlineContent":[{"text":"Certificate update events of the connected locking device can be listened by","type":"text"},{"text":" ","type":"text"},{"text":"calling ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming\/getLockCertificateEvents()"},{"text":" API. These update events can be used to convey","type":"text"},{"text":" ","type":"text"},{"text":"information to end users, for example update app UI based on events. When there is no ongoing update process,","type":"text"},{"text":" ","type":"text"},{"text":"events will not be emitted.","type":"text"}],"type":"paragraph"},{"name":"Tip","style":"tip","content":[{"type":"paragraph","inlineContent":[{"text":"","type":"text"},{"text":" ","type":"text"},{"text":"Sample code and additional documentation can be found ","type":"text"},{"overridingTitle":"here","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming\/getLockCertificateEvents()","overridingTitleInlineContent":[{"type":"text","text":"here"}],"type":"reference","isActive":true}]}],"type":"aside"},{"level":2,"text":"Request queued state","anchor":"Request-queued-state","type":"heading"},{"inlineContent":[{"text":"Certificate update process requires internet connection. If internet connection is not available or network","type":"text"},{"text":" ","type":"text"},{"text":"error occurs, certificate update will end up in ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateStateChange\/requestQueued"},{"text":" -state.","type":"text"},{"text":" ","type":"text"},{"text":"Certificate update will be tried again when connecting to the locking device next time.","type":"text"}],"type":"paragraph"},{"name":"Important","style":"important","content":[{"inlineContent":[{"type":"text","text":""},{"type":"text","text":" "},{"type":"text","text":"In case the locking device firmware version does not support update, the SDK will broadcast a"},{"type":"text","text":" "},{"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateStateChange\/certificateUpdateNotSupported","type":"reference","isActive":true},{"type":"text","text":" event. Certificate update process will not start"},{"type":"text","text":" "},{"type":"text","text":"if the firmware does not support it."}],"type":"paragraph"}],"type":"aside"},{"name":"Note","style":"note","content":[{"inlineContent":[{"text":"","type":"text"},{"text":" ","type":"text"},{"text":"If internet connection is not available during the certificate update process, it is possible to","type":"text"},{"text":" ","type":"text"},{"text":"try to request the certificate in background when app is not active and the mobile device","type":"text"},{"text":" ","type":"text"},{"text":"is connected to the internet by ","type":"text"},{"overridingTitleInlineContent":[{"text":"enabling background syncing","type":"text"}],"overridingTitle":"enabling background syncing","isActive":true,"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/BackgroundSyncing","type":"reference"},{"text":".","type":"text"}],"type":"paragraph"}],"type":"aside"},{"level":2,"text":"Further Reading","anchor":"Further-Reading","type":"heading"},{"style":"list","items":["doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/Connecting","doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock","doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/BackgroundSyncing"],"type":"links"}],"kind":"content"}],"hierarchy":{"paths":[["doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK"]]},"schemaVersion":{"major":0,"patch":0,"minor":3},"seeAlsoSections":[{"generated":true,"anchor":"Locking-Device-Certificate-Updates","identifiers":["doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming\/getLockCertificateEvents()","doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateEvent"],"title":"Locking Device Certificate Updates"}],"references":{"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockingDeviceCertificateStateChange/requestQueued":{"url":"\/documentation\/abloycubemobilesdk\/lockingdevicecertificatestatechange\/requestqueued","type":"topic","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateStateChange\/requestQueued","kind":"symbol","abstract":[{"text":"Certificate requesting failed due to a network error and requesting is being queued","type":"text"}],"title":"LockingDeviceCertificateStateChange.requestQueued","fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"text":"requestQueued","kind":"identifier"}],"role":"symbol"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/CertificateState/issuing":{"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/issuing","role":"symbol","fragments":[{"kind":"keyword","text":"case"},{"kind":"text","text":" "},{"kind":"identifier","text":"issuing"}],"url":"\/documentation\/abloycubemobilesdk\/certificatestate\/issuing","kind":"symbol","abstract":[{"type":"text","text":"Server is preparing lock certificate"}],"title":"CertificateState.issuing","type":"topic"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/DiscoveredLock":{"title":"DiscoveredLock","abstract":[{"type":"text","text":"Represents a locking device that is advertising and has been discovered by bluetooth scanning."}],"kind":"symbol","navigatorTitle":[{"kind":"identifier","text":"DiscoveredLock"}],"url":"\/documentation\/abloycubemobilesdk\/discoveredlock","role":"symbol","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"DiscoveredLock"}],"type":"topic","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/Connecting":{"type":"topic","url":"\/documentation\/abloycubemobilesdk\/connecting","kind":"article","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/Connecting","title":"Connecting to a Locking Device","abstract":[{"text":"Connect to and disconnect from a nearby locking device.","type":"text"}],"role":"article"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK":{"title":"AbloyCuBeMobileSDK","abstract":[{"text":"Control Abloy locking devices from within your app.","type":"text"}],"kind":"symbol","url":"\/documentation\/abloycubemobilesdk","type":"topic","role":"collection","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/CertificateState/readyForInstall":{"fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"text":"readyForInstall","kind":"identifier"}],"kind":"symbol","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/readyForInstall","role":"symbol","type":"topic","title":"CertificateState.readyForInstall","url":"\/documentation\/abloycubemobilesdk\/certificatestate\/readyforinstall","abstract":[{"type":"text","text":"Lock certificate is downloaded and will be installed next time the locking device is connected"}]},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockingDeviceCertificateEvent":{"kind":"symbol","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateEvent","type":"topic","navigatorTitle":[{"kind":"identifier","text":"LockingDeviceCertificateEvent"}],"url":"\/documentation\/abloycubemobilesdk\/lockingdevicecertificateevent","role":"symbol","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"LockingDeviceCertificateEvent"}],"title":"LockingDeviceCertificateEvent","abstract":[{"type":"text","text":"Locking device certificate update event received by subscribing to "},{"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming","type":"reference","isActive":true}]},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockCertificateEventStreaming/getLockCertificateEvents()":{"role":"symbol","required":true,"type":"topic","kind":"symbol","abstract":[{"text":"Stream of events when lock certificate update is ongoing","type":"text"}],"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming\/getLockCertificateEvents()","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"getLockCertificateEvents","kind":"identifier"},{"text":"() -> ","kind":"text"},{"text":"AsyncStream","kind":"typeIdentifier","preciseIdentifier":"s:ScS"},{"text":"<","kind":"text"},{"text":"LockingDeviceCertificateEvent","kind":"typeIdentifier","preciseIdentifier":"s:18AbloyCuBeMobileSDK29LockingDeviceCertificateEventV"},{"text":">","kind":"text"}],"url":"\/documentation\/abloycubemobilesdk\/lockcertificateeventstreaming\/getlockcertificateevents()","title":"getLockCertificateEvents()"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/DiscoveredLock/certificateState":{"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock\/certificateState","kind":"symbol","role":"symbol","fragments":[{"text":"let","kind":"keyword"},{"text":" ","kind":"text"},{"text":"certificateState","kind":"identifier"},{"text":": ","kind":"text"},{"text":"CertificateState","kind":"typeIdentifier","preciseIdentifier":"s:18AbloyCuBeMobileSDK16CertificateStateO"}],"url":"\/documentation\/abloycubemobilesdk\/discoveredlock\/certificatestate","type":"topic","title":"certificateState","abstract":[]},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/BackgroundSyncing":{"kind":"article","abstract":[{"text":"Synchronize and process SDK data in background when the application is not active","type":"text"}],"title":"Background Syncing","role":"article","type":"topic","url":"\/documentation\/abloycubemobilesdk\/backgroundsyncing","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/BackgroundSyncing"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockCertificateEventStreaming":{"abstract":[{"type":"text","text":"Get locking device certificate update events"}],"url":"\/documentation\/abloycubemobilesdk\/lockcertificateeventstreaming","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEventStreaming","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"LockCertificateEventStreaming"}],"kind":"symbol","role":"symbol","title":"LockCertificateEventStreaming","navigatorTitle":[{"kind":"identifier","text":"LockCertificateEventStreaming"}],"type":"topic"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/CertificateState/pending":{"type":"topic","role":"symbol","title":"CertificateState.pending","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/pending","abstract":[{"text":"Lock certificate will expire soon and a new certificate will be requested next time the locking","type":"text"},{"text":" ","type":"text"},{"text":"device is connected","type":"text"}],"url":"\/documentation\/abloycubemobilesdk\/certificatestate\/pending","kind":"symbol","fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"text":"pending","kind":"identifier"}]},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockingDeviceCertificateStateChange/certificateUpdateNotSupported":{"kind":"symbol","url":"\/documentation\/abloycubemobilesdk\/lockingdevicecertificatestatechange\/certificateupdatenotsupported","role":"symbol","title":"LockingDeviceCertificateStateChange.certificateUpdateNotSupported","abstract":[{"type":"text","text":"Locking device model or locking device firmware version does not support certificate updating"}],"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockingDeviceCertificateStateChange\/certificateUpdateNotSupported","type":"topic","fragments":[{"kind":"keyword","text":"case"},{"kind":"text","text":" "},{"kind":"identifier","text":"certificateUpdateNotSupported"}]}}}