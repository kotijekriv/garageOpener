{"identifier":{"url":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateUpdating","interfaceLanguage":"swift"},"abstract":[{"text":"Update the certificate of the locking device.","type":"text"}],"kind":"article","sections":[],"seeAlsoSections":[{"anchor":"Locking-Device-Certificate-Updates","identifiers":["doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/AbloyMobileSDK\/getLockCertificateEvents()"],"title":"Locking Device Certificate Updates","generated":true}],"primaryContentSections":[{"kind":"content","content":[{"anchor":"Overview","level":2,"type":"heading","text":"Overview"},{"inlineContent":[{"text":"The Abloy Keyless solution uses asymmetric cryptography to secure the communication between locking devices and mobile","type":"text"},{"text":" ","type":"text"},{"text":"devices. Each locking device has its of own certificate for establishing this secure communication. The certificates","type":"text"},{"text":" ","type":"text"},{"text":"also have an expiration date. Locking devices with expired certificates are inoperable and are considered untrustworthy","type":"text"},{"text":" ","type":"text"},{"text":"for the rest of the Keyless system.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"In order to keep locking devices operational and trustworthy, their certificates need to be updated.","type":"text"},{"text":" ","type":"text"},{"text":"Update is performed automatically in the background by the Abloy Keyless Mobile SDK. It is worth to note that","type":"text"},{"text":" ","type":"text"},{"text":"any mobile device user connecting to a lock may start the update process at any given time.","type":"text"}],"type":"paragraph"},{"style":"important","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":""},{"type":"text","text":" "},{"type":"text","text":"This process happens very rarely, approximately once a year. No action from the mobile app using the SDK is required."}]}],"type":"aside","name":"Important"},{"inlineContent":[{"text":"Current status of the locking device certificate is checked when performing lock connection.","type":"text"},{"text":" ","type":"text"},{"text":"If the certificate needs to be updated, new certificate will be fetched and installed to the","type":"text"},{"text":" ","type":"text"},{"text":"locking device. During the update process, the locking device will reboot and reconnect after the new","type":"text"},{"text":" ","type":"text"},{"text":"certificate is installed to the locking device.","type":"text"}],"type":"paragraph"},{"anchor":"Discovered-lock-and-certificate-state","level":2,"type":"heading","text":"Discovered lock and certificate state"},{"inlineContent":[{"text":"SDK integrators can determine whether update process will happen on next locking device connection from the","type":"text"},{"text":" ","type":"text"},{"text":"DiscoveredLockâ€™s ","type":"text"},{"isActive":true,"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock\/certificateState","type":"reference"},{"text":". If the state is either ","type":"text"},{"overridingTitleInlineContent":[{"code":"pending","type":"codeVoice"}],"isActive":true,"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/pending","type":"reference","overridingTitle":"pending"},{"text":",","type":"text"},{"text":" ","type":"text"},{"overridingTitleInlineContent":[{"code":"issuing","type":"codeVoice"}],"isActive":true,"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/issuing","type":"reference","overridingTitle":"issuing"},{"text":" or ","type":"text"},{"overridingTitleInlineContent":[{"type":"codeVoice","code":"readyForInstall"}],"isActive":true,"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/readyForInstall","type":"reference","overridingTitle":"readyForInstall"},{"text":", the next","type":"text"},{"text":" ","type":"text"},{"text":"connection will start certificate updating process.","type":"text"}],"type":"paragraph"},{"anchor":"How-to-listen-for-certificate-update-events","level":2,"type":"heading","text":"How to listen for certificate update events"},{"inlineContent":[{"type":"text","text":"Certificate update events of the connected locking device can be listened by"},{"type":"text","text":" "},{"type":"text","text":"calling "},{"type":"reference","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/AbloyMobileSDK\/getLockCertificateEvents()","isActive":true},{"type":"text","text":" API. These update events can be used to convey"},{"type":"text","text":" "},{"type":"text","text":"information to end users, for example update app UI based on events. When there is no ongoing update process,"},{"type":"text","text":" "},{"type":"text","text":"events will not be emitted."}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["import AbloyCuBeMobileSDK","","func getLockCertificateEvents() {","    let lockCertificateEvents = AbloyMobileSDK.shared.getLockCertificateEvents()","","    Task {","        for await event in lockCertificateEvents {","            switch event {","                case .requesting:","                    print(\"Got requesting event\")","                case .requestQueued:","                    print(\"Got requestQueued event\")","                case .installing:","                    print(\"Got installing event\")","                case .lockRebooting:","                    print(\"Got lockRebooting event\")","                case .lockRebooted:","                    print(\"Got lockRebooted event\")","                case .lockRebootingFailed:","                    print(\"Got lockRebootingFailed event\")","                case .failed:","                    print(\"Got failed event\")","                case .rekeyingNotSupported:","                    print(\"Got rekeyingNotSupported event\")","            }","        }","    }","}"]},{"anchor":"Request-queued-state","level":2,"type":"heading","text":"Request queued state"},{"inlineContent":[{"type":"text","text":"Certificate update process requires internet connection. If internet connection is not available or network"},{"text":" ","type":"text"},{"text":"error occurs, certificate update will end up in ","type":"text"},{"isActive":true,"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEvent\/requestQueued","type":"reference"},{"text":" -state. Certificate update","type":"text"},{"text":" ","type":"text"},{"text":"will be tried again when connecting to the locking device next time.","type":"text"}],"type":"paragraph"},{"style":"important","content":[{"inlineContent":[{"type":"text","text":""},{"type":"text","text":" "},{"type":"text","text":"In case the locking device firmware version does not support update, the SDK will broadcast a"},{"type":"text","text":" "},{"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEvent\/rekeyingNotSupported","type":"reference","isActive":true},{"type":"text","text":" event. Certificate update process will not start if the firmware does"},{"type":"text","text":" "},{"type":"text","text":"not support it."}],"type":"paragraph"}],"type":"aside","name":"Important"},{"style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":""},{"type":"text","text":" "},{"type":"text","text":"If internet connection is not available during the certificate update process, it is possible to"},{"type":"text","text":" "},{"type":"text","text":"try to request the certificate in background when app is not active and the mobile device"},{"type":"text","text":" "},{"type":"text","text":"is connected to the internet by "},{"type":"reference","overridingTitle":"enabling background syncing","overridingTitleInlineContent":[{"text":"enabling background syncing","type":"text"}],"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/BackgroundSyncing","isActive":true},{"type":"text","text":"."}]}],"type":"aside","name":"Note"},{"anchor":"Further-Reading","level":2,"type":"heading","text":"Further Reading"},{"style":"list","items":["doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/Connecting","doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock","doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/BackgroundSyncing"],"type":"links"}]}],"metadata":{"title":"Certificate Updating","roleHeading":"Article","modules":[{"name":"AbloyCuBeMobileSDK"}],"role":"article"},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/abloycubemobilesdk\/certificateupdating"]}],"schemaVersion":{"patch":0,"major":0,"minor":3},"hierarchy":{"paths":[["doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK"]]},"references":{"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/CertificateState/readyForInstall":{"type":"topic","role":"symbol","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/readyForInstall","url":"\/documentation\/abloycubemobilesdk\/certificatestate\/readyforinstall","kind":"symbol","fragments":[{"kind":"keyword","text":"case"},{"kind":"text","text":" "},{"kind":"identifier","text":"readyForInstall"}],"abstract":[{"text":"Lock certificate is downloaded and will be installed next time the locking device is connected","type":"text"}],"title":"CertificateState.readyForInstall"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/CertificateState/issuing":{"type":"topic","role":"symbol","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/issuing","url":"\/documentation\/abloycubemobilesdk\/certificatestate\/issuing","kind":"symbol","fragments":[{"kind":"keyword","text":"case"},{"kind":"text","text":" "},{"kind":"identifier","text":"issuing"}],"abstract":[{"type":"text","text":"Server is preparing lock certificate"}],"title":"CertificateState.issuing"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/AbloyMobileSDK/getLockCertificateEvents()":{"type":"topic","kind":"symbol","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/AbloyMobileSDK\/getLockCertificateEvents()","title":"getLockCertificateEvents()","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"getLockCertificateEvents","kind":"identifier"},{"text":"() -> ","kind":"text"},{"text":"LockCertificateEventStream","kind":"typeIdentifier","preciseIdentifier":"s:18AbloyCuBeMobileSDK26LockCertificateEventStreama"}],"abstract":[{"text":"Stream of events when lock certificate update is ongoing","type":"text"}],"url":"\/documentation\/abloycubemobilesdk\/abloymobilesdk\/getlockcertificateevents()","role":"symbol"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/Connecting":{"url":"\/documentation\/abloycubemobilesdk\/connecting","title":"Connecting to a Locking Device","type":"topic","role":"article","abstract":[{"text":"Connect to and disconnect from a nearby locking device.","type":"text"}],"kind":"article","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/Connecting"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/DiscoveredLock/certificateState":{"type":"topic","kind":"symbol","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock\/certificateState","title":"certificateState","fragments":[{"kind":"keyword","text":"let"},{"kind":"text","text":" "},{"kind":"identifier","text":"certificateState"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:18AbloyCuBeMobileSDK16CertificateStateO","text":"CertificateState"}],"abstract":[],"url":"\/documentation\/abloycubemobilesdk\/discoveredlock\/certificatestate","role":"symbol"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/DiscoveredLock":{"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"DiscoveredLock","kind":"identifier"}],"url":"\/documentation\/abloycubemobilesdk\/discoveredlock","type":"topic","navigatorTitle":[{"text":"DiscoveredLock","kind":"identifier"}],"kind":"symbol","role":"symbol","title":"DiscoveredLock","abstract":[{"text":"Represents a locking device that is advertising and has been discovered by bluetooth scanning.","type":"text"}],"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/DiscoveredLock"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/BackgroundSyncing":{"type":"topic","abstract":[{"text":"Synchronize and process SDK data in background when the application is not active","type":"text"}],"identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/BackgroundSyncing","role":"article","title":"Background Syncing","url":"\/documentation\/abloycubemobilesdk\/backgroundsyncing","kind":"article"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK":{"abstract":[{"text":"Control Abloy locking devices from within your app.","type":"text"}],"type":"topic","kind":"symbol","url":"\/documentation\/abloycubemobilesdk","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK","role":"collection","title":"AbloyCuBeMobileSDK"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockCertificateEvent/requestQueued":{"kind":"symbol","abstract":[{"type":"text","text":"Lock certificate requesting failed due to a network error and requesting is being queued"}],"fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"text":"requestQueued","kind":"identifier"}],"url":"\/documentation\/abloycubemobilesdk\/lockcertificateevent\/requestqueued","role":"symbol","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEvent\/requestQueued","type":"topic","title":"LockCertificateEvent.requestQueued"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/LockCertificateEvent/rekeyingNotSupported":{"url":"\/documentation\/abloycubemobilesdk\/lockcertificateevent\/rekeyingnotsupported","abstract":[{"type":"text","text":"Locking device model or locking device firmware version does not support certificate updating"}],"role":"symbol","title":"LockCertificateEvent.rekeyingNotSupported","fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"text":"rekeyingNotSupported","kind":"identifier"}],"kind":"symbol","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/LockCertificateEvent\/rekeyingNotSupported","type":"topic"},"doc://com.abloy.AbloyMobileSDK/documentation/AbloyCuBeMobileSDK/CertificateState/pending":{"kind":"symbol","abstract":[{"text":"Lock certificate will expire soon and a new certificate will be requested next time the locking","type":"text"},{"text":" ","type":"text"},{"text":"device is connected","type":"text"}],"role":"symbol","fragments":[{"kind":"keyword","text":"case"},{"kind":"text","text":" "},{"kind":"identifier","text":"pending"}],"url":"\/documentation\/abloycubemobilesdk\/certificatestate\/pending","identifier":"doc:\/\/com.abloy.AbloyMobileSDK\/documentation\/AbloyCuBeMobileSDK\/CertificateState\/pending","title":"CertificateState.pending","type":"topic"}}}